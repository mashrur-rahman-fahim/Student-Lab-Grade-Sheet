using System;
using System.Text.RegularExpressions;

namespace StudentLabGradeSheet
{
    public static class ValidationHelper
    {
        public static bool IsValidRollNumber(string rollNo)
        {
            if (string.IsNullOrWhiteSpace(rollNo))
                return false;

            // Pattern for roll numbers like 2019-SE-001, 2020-CS-123, etc.
            string pattern = @"^\d{4}-[A-Z]{2,4}-\d{3}$";
            return Regex.IsMatch(rollNo.ToUpper(), pattern);
        }

        public static bool IsValidName(string name)
        {
            if (string.IsNullOrWhiteSpace(name))
                return false;

            // Name should contain only letters and spaces, at least 2 characters
            string pattern = @"^[a-zA-Z\s]{2,50}$";
            return Regex.IsMatch(name.Trim(), pattern);
        }

        public static bool IsValidMarks(int marks, int maxMarks)
        {
            return marks >= 0 && marks <= maxMarks;
        }

        public static string FormatRollNumber(string rollNo)
        {
            if (string.IsNullOrWhiteSpace(rollNo))
                return "";

            return rollNo.ToUpper().Trim();
        }

        public static string FormatName(string name)
        {
            if (string.IsNullOrWhiteSpace(name))
                return "";

            // Capitalize first letter of each word
            return System.Globalization.CultureInfo.CurrentCulture.TextInfo.ToTitleCase(name.ToLower().Trim());
        }
    }
}